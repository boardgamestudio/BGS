# Combined .htaccess: Node.js Passenger + React Router SPA fallback
# This file is REQUIRED by cPanel for Node.js apps

# Node.js Passenger configuration
PassengerEnabled on
PassengerAppRoot /home/peoplein/public_html/api
PassengerStartupFile server.js
PassengerAppType node
PassengerNodejs /home/peoplein/nodevenv/public_html/api/22/bin/node

# Environment variables will be added here by cPanel

# React Router SPA fallback configuration
# This ensures direct URLs like /login, /register, /admin work properly

RewriteEngine On
RewriteBase /

# Don't rewrite files or directories that exist
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Don't rewrite API routes (they should go to the Node.js server)
RewriteCond %{REQUEST_URI} !^/(projects|jobs|events|users|design-diaries|health|auth|admin)

# Don't rewrite assets folder
RewriteCond %{REQUEST_URI} !^/assets/

# Rewrite everything else to index.html for React Router
RewriteRule ^.*$ /index.html [L]
